05/14/2024 22:23:45 - WARNING - __main__ -   device: cuda, n_gpu: 8
/home/siddharthsa/miniconda3/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/codebert-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
05/14/2024 22:23:50 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../dataset/tamal_train.jsonl', output_dir='./saved_models', eval_data_file='../dataset/tamal_valid.jsonl', test_data_file='../dataset/tamal_test.jsonl', model_name_or_path='microsoft/codebert-base', tokenizer_name='microsoft/codebert-base', block_size=256, do_train=True, do_eval=False, do_test=False, train_batch_size=64, eval_batch_size=16, learning_rate=2e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, warmup_steps=0, seed=123456, num_train_epochs=25, n_gpu=8, device=device(type='cuda'))
05/14/2024 22:24:12 - INFO - __main__ -   *** Example ***
05/14/2024 22:24:12 - INFO - __main__ -   label: 0
05/14/2024 22:24:12 - INFO - __main__ -   input_tokens: ['<s>', 'public', '_class', '_Main', '_{', '_public', '_static', '_void', '_main', '(', 'String', '[]', '_args', ')', '_{', '_Buff', 'ered', 'Reader', '_in', '_=', '_new', '_Buff', 'ered', 'Reader', '(', 'new', '_Input', 'Stream', 'Reader', '(', 'System', '.', 'in', '));', '_int', '_height', '[]', '_=', '_new', '_int', '[', '10', '];', '_int', '_out', '[]', '_=', '_{', '0', ',', '0', ',', '0', '};', '_for', '(', 'int', '_i', '_=', '_0', ';', '_i', '_<', '_10', ';', '_i', '++', '){', '_try', '{', '_height', '[', 'i', ']', '_=', '_Integer', '.', 'parse', 'Int', '(', 'in', '.', 'read', 'Line', '());', '_}', 'catch', '(', 'IO', 'Exception', '_e', '){', '}', '_}', '_for', '(', 'int', '_i', '_=', '_0', ';', '_i', '_<', '_height', '.', 'length', ';', '_i', '++', '){', '_if', '(', 'out', '[', '0', ']', '_<', '_height', '[', 'i', ']', '_)', '{', '_out', '[', '2', ']', '_=', '_out', '[', '1', '];', '_out', '[', '1', ']', '_=', '_out', '[', '0', '];', '_out', '[', '0', ']', '_=', '_height', '[', 'i', '];', '_}', 'else', '_if', '(', 'out', '[', '1', ']', '_<', '_height', '[', 'i', '])', '{', '_out', '[', '2', ']', '_=', '_out', '[', '1', '];', '_out', '[', '1', ']', '_=', '_height', '[', 'i', '];', '_}', 'else', '_if', '(', 'out', '[', '2', ']', '_<', '_height', '[', 'i', '])', '{', '_out', '[', '2', ']', '_=', '_height', '[', 'i', '];', '_}', '_}', '_for', '(', 'int', '_i', '_=', '_0', ';', '_i', '_<', '_out', '.', 'length', ';', '_i', '++', '){', '_System', '.', 'out', '.', 'println', '(', 'out', '[', 'i', ']);', '_}', '_}', '_}', '</s>']
05/14/2024 22:24:12 - INFO - __main__ -   input_ids: 0 15110 1380 4326 25522 285 25156 13842 1049 1640 34222 48992 49503 43 25522 18601 3215 46347 11 5457 92 18601 3215 46347 1640 4651 41327 36757 46347 1640 36383 4 179 48749 6979 6958 48992 5457 92 6979 10975 698 44082 6979 66 48992 5457 25522 288 6 288 6 288 49423 13 1640 2544 939 5457 321 131 939 28696 158 131 939 42964 48512 860 45152 6958 10975 118 742 5457 47927 4 48778 22886 1640 179 4 12745 18997 49291 35524 36847 1640 6454 48847 364 48512 24303 35524 13 1640 2544 939 5457 321 131 939 28696 6958 4 16096 131 939 42964 48512 114 1640 995 10975 288 742 28696 6958 10975 118 742 4839 45152 66 10975 176 742 5457 66 10975 134 44082 66 10975 134 742 5457 66 10975 288 44082 66 10975 288 742 5457 6958 10975 118 44082 35524 44617 114 1640 995 10975 134 742 28696 6958 10975 118 45587 45152 66 10975 176 742 5457 66 10975 134 44082 66 10975 134 742 5457 6958 10975 118 44082 35524 44617 114 1640 995 10975 176 742 28696 6958 10975 118 45587 45152 66 10975 176 742 5457 6958 10975 118 44082 35524 35524 13 1640 2544 939 5457 321 131 939 28696 66 4 16096 131 939 42964 48512 5149 4 995 4 49396 1640 995 10975 118 48601 35524 35524 35524 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
05/14/2024 22:24:12 - INFO - __main__ -   *** Example ***
05/14/2024 22:24:12 - INFO - __main__ -   label: 0
05/14/2024 22:24:12 - INFO - __main__ -   input_tokens: ['<s>', 'class', '_Main', '{', '_public', '_static', '_void', '_main', '(', 'String', '[]', '_args', ')', 'th', 'rows', '_IO', 'Exception', '{', '_Integer', '[]', '_height', '=', 'new', '_Integer', '[', '10', '];', '_Buff', 'ered', 'Reader', '_br', '=', 'new', '_Buff', 'ered', 'Reader', '(', 'new', '_Input', 'Stream', 'Reader', '(', 'System', '.', 'in', '));', '_for', '(', 'int', '_i', '=', '0', ';', '_i', '<', '10', ';', '_i', '++', '){', '_height', '[', 'i', ']=', 'Integer', '.', 'value', 'Of', '(', 'br', '.', 'read', 'Line', '());', '_}', '_int', '_a', '=', '0', ';', '_for', '(', 'int', '_j', '=', '0', ';', '_j', '<', '9', ';', '_j', '++', '){', '_for', '(', 'int', '_k', '=', '9', ';', '_k', '>', 'j', ';', '_k', '--', '){', '_if', '(', 'height', '[', 'k', ']', '<', 'height', '[', 'k', '-', '1', '])', '{', '_a', '=', 'height', '[', 'k', '];', '_height', '[', 'k', ']=', 'height', '[', 'k', '-', '1', '];', '_height', '[', 'k', '-', '1', ']=', 'a', ';', '_}', '_}', '_}', '_for', '(', 'int', '_l', '=', '0', ';', '_l', '<', '3', ';', '_l', '++', '){', '_System', '.', 'out', '.', 'println', '(', 'height', '[', '9', '-', 'l', ']);', '_}', '_}', '_}', '</s>']
05/14/2024 22:24:12 - INFO - __main__ -   input_ids: 0 4684 4326 45152 285 25156 13842 1049 1640 34222 48992 49503 43 212 13415 38266 48847 45152 47927 48992 6958 5214 4651 47927 10975 698 44082 18601 3215 46347 5378 5214 4651 18601 3215 46347 1640 4651 41327 36757 46347 1640 36383 4 179 48749 13 1640 2544 939 5214 288 131 939 41552 698 131 939 42964 48512 6958 10975 118 49659 49740 4 19434 10643 1640 3809 4 12745 18997 49291 35524 6979 10 5214 288 131 13 1640 2544 1236 5214 288 131 1236 41552 466 131 1236 42964 48512 13 1640 2544 449 5214 466 131 449 15698 267 131 449 5579 48512 114 1640 37009 10975 330 742 41552 37009 10975 330 12 134 45587 45152 10 5214 37009 10975 330 44082 6958 10975 330 49659 37009 10975 330 12 134 44082 6958 10975 330 12 134 49659 102 131 35524 35524 35524 13 1640 2544 784 5214 288 131 784 41552 246 131 784 42964 48512 5149 4 995 4 49396 1640 37009 10975 466 12 462 48601 35524 35524 35524 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
05/14/2024 22:24:12 - INFO - __main__ -   *** Example ***
05/14/2024 22:24:12 - INFO - __main__ -   label: 0
05/14/2024 22:24:12 - INFO - __main__ -   input_tokens: ['<s>', 'public', '_class', '_Main', '_{', '_public', '_static', '_void', '_main', '(', 'String', '[]', '_args', ')', '_throws', '_IO', 'Exception', '_{', '_int', '[]', '_data', '_=', '_new', '_int', '[', '10', '];', '_final', '_String', '_BR', '_=', '_System', '.', 'get', 'Property', '("', 'line', '.', 'separ', 'ator', '");', '_int', '_first', '_=', '_0', ',', '_second', '_=', '_0', ',', '_third', '_=', '_0', ';', '_Buff', 'ered', 'Reader', '_in', '_=', '_new', '_Buff', 'ered', 'Reader', '(', 'new', '_Input', 'Stream', 'Reader', '(', 'System', '.', 'in', '));', '_for', '_(', 'int', '_i', '_=', '_0', ';', '_i', '_<', '_10', ';', '_i', '++)', '_{', '_data', '[', 'i', ']', '_=', '_Integer', '.', 'parse', 'Int', '(', 'in', '.', 'read', 'Line', '());', '_}', '_for', '_(', 'int', '_dat', 'um', '_:', '_data', ')', '_{', '_int', '_temp', '1', '_=', '_0', ',', '_temp', '2', '_=', '_0', ';', '_for', '_(', 'int', '_j', '_=', '_1', ';', '_j', '_<=', '_3', ';', '_j', '++)', '_{', '_if', '_(', 'first', '_<', '_dat', 'um', ')', '_{', '_temp', '1', '_=', '_first', ';', '_temp', '2', '_=', '_second', ';', '_first', '_=', '_dat', 'um', ';', '_second', '_=', '_temp', '1', ';', '_third', '_=', '_temp', '2', ';', '_break', ';', '_}', '_if', '_(', 'second', '_<', '_dat', 'um', ')', '_{', '_temp', '2', '_=', '_second', ';', '_second', '_=', '_dat', 'um', ';', '_third', '_=', '_temp', '2', ';', '_break', ';', '_}', '_if', '_(', 'third', '_<', '_dat', 'um', ')', '_{', '_third', '_=', '_dat', 'um', ';', '_}', '_}', '_}', '_System', '.', 'out', '.', 'println', '(', 'first', '_+', '_BR', '_+', '_second', '_+', '_BR', '_+', '_third', ');', '_}', '_}', '</s>']
05/14/2024 22:24:12 - INFO - __main__ -   input_ids: 0 15110 1380 4326 25522 285 25156 13842 1049 1640 34222 48992 49503 43 6989 38266 48847 25522 6979 48992 414 5457 92 6979 10975 698 44082 507 26602 6823 5457 5149 4 6460 44720 46469 1902 4 39114 2630 45751 6979 78 5457 321 6 200 5457 321 6 371 5457 321 131 18601 3215 46347 11 5457 92 18601 3215 46347 1640 4651 41327 36757 46347 1640 36383 4 179 48749 13 36 2544 939 5457 321 131 939 28696 158 131 939 49346 25522 414 10975 118 742 5457 47927 4 48778 22886 1640 179 4 12745 18997 49291 35524 13 36 2544 13516 783 4832 414 43 25522 6979 32196 134 5457 321 6 32196 176 5457 321 131 13 36 2544 1236 5457 112 131 1236 49230 155 131 1236 49346 25522 114 36 9502 28696 13516 783 43 25522 32196 134 5457 78 131 32196 176 5457 200 131 78 5457 13516 783 131 200 5457 32196 134 131 371 5457 32196 176 131 1108 131 35524 114 36 10815 28696 13516 783 43 25522 32196 176 5457 200 131 200 5457 13516 783 131 371 5457 32196 176 131 1108 131 35524 114 36 12347 28696 13516 783 43 25522 371 5457 13516 783 131 35524 35524 35524 5149 4 995 4 49396 1640 9502 2055 6823 2055 200 2055 6823 2055 371 4397 35524 35524 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
/home/siddharthsa/miniconda3/lib/python3.11/site-packages/transformers/optimization.py:521: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
05/14/2024 22:24:12 - INFO - __main__ -   ***** Running training *****
05/14/2024 22:24:12 - INFO - __main__ -     Num examples = 44015
05/14/2024 22:24:12 - INFO - __main__ -     Num Epochs = 25
05/14/2024 22:24:12 - INFO - __main__ -     batch size = 64
05/14/2024 22:24:12 - INFO - __main__ -     Total optimization steps = 17200
  0%|          | 0/688 [00:00<?, ?it/s]  0%|          | 0/688 [00:02<?, ?it/s]
Traceback (most recent call last):
  File "/home/siddharthsa/BugDetection/CodeBERT-classification-Baseline1/code/run.py", line 399, in <module>
    main()
  File "/home/siddharthsa/BugDetection/CodeBERT-classification-Baseline1/code/run.py", line 367, in main
    train(args, train_dataset, model, tokenizer)
  File "/home/siddharthsa/BugDetection/CodeBERT-classification-Baseline1/code/run.py", line 147, in train
    loss.backward()
  File "/home/siddharthsa/miniconda3/lib/python3.11/site-packages/torch/_tensor.py", line 525, in backward
    torch.autograd.backward(
  File "/home/siddharthsa/miniconda3/lib/python3.11/site-packages/torch/autograd/__init__.py", line 267, in backward
    _engine_run_backward(
  File "/home/siddharthsa/miniconda3/lib/python3.11/site-packages/torch/autograd/graph.py", line 744, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 192.00 MiB. GPU 

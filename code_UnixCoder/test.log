05/15/2024 11:36:01 - WARNING - __main__ -   device: cuda, n_gpu: 8
/home/siddharthsa/miniconda3/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/unixcoder-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
05/15/2024 11:36:06 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../dataset/tamal_train.jsonl', output_dir='./saved_models/', eval_data_file='../dataset/tamal_valid.jsonl', test_data_file='../dataset/tamal_test.jsonl', model_name_or_path='microsoft/unixcoder-base', tokenizer_name='', block_size=256, do_train=False, do_eval=True, do_test=True, train_batch_size=64, eval_batch_size=32, learning_rate=2e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, warmup_steps=0, seed=123456, num_train_epochs=1, n_gpu=8, device=device(type='cuda'))
05/15/2024 11:36:09 - INFO - __main__ -   ***** Running evaluation *****
05/15/2024 11:36:09 - INFO - __main__ -     Num examples = 5396
05/15/2024 11:36:09 - INFO - __main__ -     Batch size = 32
05/15/2024 11:38:46 - INFO - __main__ -   ***** Eval results *****
05/15/2024 11:38:46 - INFO - __main__ -     eval_acc = 0.9939
05/15/2024 11:38:46 - INFO - __main__ -     eval_f1 = 0.9937
05/15/2024 11:38:46 - INFO - __main__ -     eval_loss = 0.0304
05/15/2024 11:38:46 - INFO - __main__ -     eval_precesion = 0.9938
05/15/2024 11:38:46 - INFO - __main__ -     eval_recall = 0.9939
05/15/2024 11:38:49 - INFO - __main__ -   ***** Running Test *****
05/15/2024 11:38:49 - INFO - __main__ -     Num examples = 5723
05/15/2024 11:38:49 - INFO - __main__ -     Batch size = 32
checkpoint-best-acc/model.bin
  0%|          | 0/179 [00:00<?, ?it/s]  1%|          | 1/179 [00:00<02:44,  1.08it/s]  1%|          | 2/179 [00:01<02:42,  1.09it/s]  2%|▏         | 3/179 [00:02<02:41,  1.09it/s]  2%|▏         | 4/179 [00:03<02:40,  1.09it/s]  3%|▎         | 5/179 [00:04<02:39,  1.09it/s]  3%|▎         | 6/179 [00:05<02:38,  1.09it/s]  4%|▍         | 7/179 [00:06<02:38,  1.09it/s]  4%|▍         | 8/179 [00:07<02:37,  1.09it/s]  5%|▌         | 9/179 [00:08<02:35,  1.09it/s]  6%|▌         | 10/179 [00:09<02:35,  1.09it/s]  6%|▌         | 11/179 [00:10<02:34,  1.09it/s]  7%|▋         | 12/179 [00:11<02:33,  1.09it/s]  7%|▋         | 13/179 [00:11<02:32,  1.09it/s]  8%|▊         | 14/179 [00:12<02:31,  1.09it/s]  8%|▊         | 15/179 [00:13<02:30,  1.09it/s]  9%|▉         | 16/179 [00:14<02:29,  1.09it/s]  9%|▉         | 17/179 [00:15<02:28,  1.09it/s] 10%|█         | 18/179 [00:16<02:27,  1.09it/s] 11%|█         | 19/179 [00:17<02:27,  1.09it/s] 11%|█         | 20/179 [00:18<02:26,  1.09it/s] 12%|█▏        | 21/179 [00:19<02:25,  1.09it/s] 12%|█▏        | 22/179 [00:20<02:24,  1.09it/s] 13%|█▎        | 23/179 [00:21<02:23,  1.09it/s] 13%|█▎        | 24/179 [00:22<02:22,  1.09it/s] 14%|█▍        | 25/179 [00:22<02:21,  1.09it/s] 15%|█▍        | 26/179 [00:23<02:21,  1.09it/s] 15%|█▌        | 27/179 [00:24<02:19,  1.09it/s] 16%|█▌        | 28/179 [00:25<02:18,  1.09it/s] 16%|█▌        | 29/179 [00:26<02:18,  1.09it/s] 17%|█▋        | 30/179 [00:27<02:17,  1.09it/s] 17%|█▋        | 31/179 [00:28<02:16,  1.09it/s] 18%|█▊        | 32/179 [00:29<02:15,  1.09it/s] 18%|█▊        | 33/179 [00:30<02:14,  1.09it/s] 19%|█▉        | 34/179 [00:31<02:13,  1.09it/s] 20%|█▉        | 35/179 [00:32<02:12,  1.09it/s] 20%|██        | 36/179 [00:33<02:11,  1.09it/s] 21%|██        | 37/179 [00:34<02:10,  1.09it/s] 21%|██        | 38/179 [00:34<02:09,  1.09it/s] 22%|██▏       | 39/179 [00:35<02:08,  1.09it/s] 22%|██▏       | 40/179 [00:36<02:07,  1.09it/s] 23%|██▎       | 41/179 [00:37<02:07,  1.09it/s] 23%|██▎       | 42/179 [00:38<02:06,  1.09it/s] 24%|██▍       | 43/179 [00:39<02:05,  1.09it/s] 25%|██▍       | 44/179 [00:40<02:04,  1.09it/s] 25%|██▌       | 45/179 [00:41<02:03,  1.09it/s] 26%|██▌       | 46/179 [00:42<02:02,  1.09it/s] 26%|██▋       | 47/179 [00:43<02:01,  1.09it/s] 27%|██▋       | 48/179 [00:44<02:00,  1.09it/s] 27%|██▋       | 49/179 [00:45<01:59,  1.09it/s] 28%|██▊       | 50/179 [00:45<01:58,  1.09it/s] 28%|██▊       | 51/179 [00:46<01:57,  1.09it/s] 29%|██▉       | 52/179 [00:47<01:56,  1.09it/s] 30%|██▉       | 53/179 [00:48<01:55,  1.09it/s] 30%|███       | 54/179 [00:49<01:54,  1.09it/s] 31%|███       | 55/179 [00:50<01:54,  1.09it/s] 31%|███▏      | 56/179 [00:51<01:53,  1.09it/s] 32%|███▏      | 57/179 [00:52<01:52,  1.09it/s] 32%|███▏      | 58/179 [00:53<01:51,  1.09it/s] 33%|███▎      | 59/179 [00:54<01:50,  1.09it/s] 34%|███▎      | 60/179 [00:55<01:49,  1.09it/s] 34%|███▍      | 61/179 [00:56<01:48,  1.09it/s] 35%|███▍      | 62/179 [00:57<01:47,  1.09it/s] 35%|███▌      | 63/179 [00:57<01:46,  1.09it/s] 36%|███▌      | 64/179 [00:58<01:45,  1.09it/s] 36%|███▋      | 65/179 [00:59<01:45,  1.09it/s] 37%|███▋      | 66/179 [01:00<01:44,  1.09it/s] 37%|███▋      | 67/179 [01:01<01:43,  1.08it/s] 38%|███▊      | 68/179 [01:02<01:42,  1.08it/s] 39%|███▊      | 69/179 [01:03<01:41,  1.09it/s] 39%|███▉      | 70/179 [01:04<01:40,  1.09it/s] 40%|███▉      | 71/179 [01:05<01:39,  1.09it/s] 40%|████      | 72/179 [01:06<01:38,  1.09it/s] 41%|████      | 73/179 [01:07<01:37,  1.09it/s] 41%|████▏     | 74/179 [01:08<01:36,  1.09it/s] 42%|████▏     | 75/179 [01:08<01:35,  1.09it/s] 42%|████▏     | 76/179 [01:09<01:34,  1.09it/s] 43%|████▎     | 77/179 [01:10<01:33,  1.09it/s] 44%|████▎     | 78/179 [01:11<01:33,  1.08it/s] 44%|████▍     | 79/179 [01:12<01:32,  1.09it/s] 45%|████▍     | 80/179 [01:13<01:31,  1.09it/s] 45%|████▌     | 81/179 [01:14<01:30,  1.09it/s] 46%|████▌     | 82/179 [01:15<01:29,  1.09it/s] 46%|████▋     | 83/179 [01:16<01:28,  1.09it/s] 47%|████▋     | 84/179 [01:17<01:27,  1.09it/s] 47%|████▋     | 85/179 [01:18<01:26,  1.09it/s] 48%|████▊     | 86/179 [01:19<01:25,  1.09it/s] 49%|████▊     | 87/179 [01:20<01:24,  1.09it/s] 49%|████▉     | 88/179 [01:20<01:23,  1.09it/s] 50%|████▉     | 89/179 [01:21<01:22,  1.09it/s] 50%|█████     | 90/179 [01:22<01:21,  1.09it/s] 51%|█████     | 91/179 [01:23<01:21,  1.09it/s] 51%|█████▏    | 92/179 [01:24<01:20,  1.09it/s] 52%|█████▏    | 93/179 [01:25<01:19,  1.09it/s] 53%|█████▎    | 94/179 [01:26<01:18,  1.09it/s] 53%|█████▎    | 95/179 [01:27<01:17,  1.09it/s] 54%|█████▎    | 96/179 [01:28<01:16,  1.09it/s] 54%|█████▍    | 97/179 [01:29<01:15,  1.09it/s] 55%|█████▍    | 98/179 [01:30<01:14,  1.09it/s] 55%|█████▌    | 99/179 [01:31<01:13,  1.09it/s] 56%|█████▌    | 100/179 [01:32<01:12,  1.09it/s] 56%|█████▋    | 101/179 [01:32<01:11,  1.09it/s] 57%|█████▋    | 102/179 [01:33<01:10,  1.09it/s] 58%|█████▊    | 103/179 [01:34<01:09,  1.09it/s] 58%|█████▊    | 104/179 [01:35<01:08,  1.09it/s] 59%|█████▊    | 105/179 [01:36<01:08,  1.09it/s] 59%|█████▉    | 106/179 [01:37<01:07,  1.09it/s] 60%|█████▉    | 107/179 [01:38<01:06,  1.09it/s] 60%|██████    | 108/179 [01:39<01:05,  1.09it/s] 61%|██████    | 109/179 [01:40<01:04,  1.09it/s] 61%|██████▏   | 110/179 [01:41<01:03,  1.09it/s] 62%|██████▏   | 111/179 [01:42<01:02,  1.08it/s] 63%|██████▎   | 112/179 [01:43<01:01,  1.09it/s] 63%|██████▎   | 113/179 [01:43<01:00,  1.09it/s] 64%|██████▎   | 114/179 [01:44<00:59,  1.09it/s] 64%|██████▍   | 115/179 [01:45<00:58,  1.09it/s] 65%|██████▍   | 116/179 [01:46<00:57,  1.09it/s] 65%|██████▌   | 117/179 [01:47<00:57,  1.09it/s] 66%|██████▌   | 118/179 [01:48<00:56,  1.09it/s] 66%|██████▋   | 119/179 [01:49<00:55,  1.09it/s] 67%|██████▋   | 120/179 [01:50<00:54,  1.08it/s] 68%|██████▊   | 121/179 [01:51<00:53,  1.08it/s] 68%|██████▊   | 122/179 [01:52<00:52,  1.09it/s] 69%|██████▊   | 123/179 [01:53<00:51,  1.09it/s] 69%|██████▉   | 124/179 [01:54<00:50,  1.09it/s] 70%|██████▉   | 125/179 [01:55<00:49,  1.09it/s] 70%|███████   | 126/179 [01:55<00:48,  1.08it/s] 71%|███████   | 127/179 [01:56<00:47,  1.09it/s] 72%|███████▏  | 128/179 [01:57<00:46,  1.09it/s] 72%|███████▏  | 129/179 [01:58<00:46,  1.09it/s] 73%|███████▎  | 130/179 [01:59<00:45,  1.09it/s] 73%|███████▎  | 131/179 [02:00<00:44,  1.09it/s] 74%|███████▎  | 132/179 [02:01<00:43,  1.09it/s] 74%|███████▍  | 133/179 [02:02<00:42,  1.09it/s] 75%|███████▍  | 134/179 [02:03<00:41,  1.09it/s] 75%|███████▌  | 135/179 [02:04<00:40,  1.09it/s] 76%|███████▌  | 136/179 [02:05<00:39,  1.09it/s] 77%|███████▋  | 137/179 [02:06<00:38,  1.09it/s] 77%|███████▋  | 138/179 [02:06<00:37,  1.09it/s] 78%|███████▊  | 139/179 [02:07<00:36,  1.09it/s] 78%|███████▊  | 140/179 [02:08<00:35,  1.09it/s] 79%|███████▉  | 141/179 [02:09<00:35,  1.09it/s] 79%|███████▉  | 142/179 [02:10<00:34,  1.09it/s] 80%|███████▉  | 143/179 [02:11<00:33,  1.09it/s] 80%|████████  | 144/179 [02:12<00:32,  1.09it/s] 81%|████████  | 145/179 [02:13<00:31,  1.09it/s] 82%|████████▏ | 146/179 [02:14<00:30,  1.09it/s] 82%|████████▏ | 147/179 [02:15<00:29,  1.09it/s] 83%|████████▎ | 148/179 [02:16<00:28,  1.09it/s] 83%|████████▎ | 149/179 [02:17<00:27,  1.09it/s] 84%|████████▍ | 150/179 [02:18<00:26,  1.09it/s] 84%|████████▍ | 151/179 [02:18<00:25,  1.09it/s] 85%|████████▍ | 152/179 [02:19<00:24,  1.09it/s] 85%|████████▌ | 153/179 [02:20<00:23,  1.09it/s] 86%|████████▌ | 154/179 [02:21<00:23,  1.09it/s] 87%|████████▋ | 155/179 [02:22<00:22,  1.09it/s] 87%|████████▋ | 156/179 [02:23<00:21,  1.09it/s] 88%|████████▊ | 157/179 [02:24<00:20,  1.09it/s] 88%|████████▊ | 158/179 [02:25<00:19,  1.09it/s] 89%|████████▉ | 159/179 [02:26<00:18,  1.09it/s] 89%|████████▉ | 160/179 [02:27<00:17,  1.09it/s] 90%|████████▉ | 161/179 [02:28<00:16,  1.08it/s] 91%|█████████ | 162/179 [02:29<00:15,  1.08it/s] 91%|█████████ | 163/179 [02:30<00:14,  1.08it/s] 92%|█████████▏| 164/179 [02:30<00:13,  1.08it/s] 92%|█████████▏| 165/179 [02:31<00:12,  1.08it/s] 93%|█████████▎| 166/179 [02:32<00:12,  1.08it/s] 93%|█████████▎| 167/179 [02:33<00:11,  1.08it/s] 94%|█████████▍| 168/179 [02:34<00:10,  1.08it/s] 94%|█████████▍| 169/179 [02:35<00:09,  1.08it/s] 95%|█████████▍| 170/179 [02:36<00:08,  1.08it/s] 96%|█████████▌| 171/179 [02:37<00:07,  1.09it/s] 96%|█████████▌| 172/179 [02:38<00:06,  1.08it/s] 97%|█████████▋| 173/179 [02:39<00:05,  1.08it/s] 97%|█████████▋| 174/179 [02:40<00:04,  1.08it/s] 98%|█████████▊| 175/179 [02:41<00:03,  1.08it/s] 98%|█████████▊| 176/179 [02:42<00:02,  1.08it/s] 99%|█████████▉| 177/179 [02:42<00:01,  1.08it/s] 99%|█████████▉| 178/179 [02:43<00:00,  1.09it/s]100%|██████████| 179/179 [02:44<00:00,  1.14it/s]100%|██████████| 179/179 [02:44<00:00,  1.09it/s]
05/15/2024 11:41:33 - INFO - __main__ -   ***** Test results *****
05/15/2024 11:41:33 - INFO - __main__ -     eval_acc = 0.9937
05/15/2024 11:41:33 - INFO - __main__ -     eval_f1 = 0.9931
05/15/2024 11:41:33 - INFO - __main__ -     eval_precesion = 0.9937
05/15/2024 11:41:33 - INFO - __main__ -     eval_recall = 0.9929
